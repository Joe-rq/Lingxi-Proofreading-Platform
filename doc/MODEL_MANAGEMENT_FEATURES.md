# 灵犀文档校对平台 - 模型管理功能

## 新增功能概览

本次更新为灵犀文档校对平台增加了完整的**AI模型管理功能**，用户现在可以为每个AI服务商选择和管理多个不同的模型。

## 主要功能特性

### 1. 多模型支持
每个AI服务商现在支持多个模型选择：

#### OpenAI
- **GPT-3.5 Turbo**: 经济实用的模型
- **GPT-4**: 更强大的模型
- **GPT-4 Turbo**: 速度更快的GPT-4
- **GPT-4o**: 最新的多模态模型

#### DeepSeek
- **DeepSeek Chat**: 通用对话模型
- **DeepSeek Coder**: 代码专用模型
- **DeepSeek R1**: 推理增强模型
- **DeepSeek R1 Lite**: R1轻量版模型

#### Google Gemini
- **Gemini 1.5 Flash**: 快速响应模型
- **Gemini 1.5 Pro**: 高性能模型
- **Gemini 1.0 Pro**: 稳定版本模型

#### Qwen (阿里云通义千问)
- **Qwen Turbo**: 快速模型
- **Qwen Plus**: 增强模型
- **Qwen Max**: 最强模型
- **Qwen2.5 72B**: 72B参数模型

#### 智谱AI
- **GLM-4**: 通用语言模型
- **GLM-4V**: 多模态模型
- **GLM-3 Turbo**: 快速模型

### 2. 模型配置管理

#### API密钥配置
- 添加API密钥时可选择启用的模型
- 支持为每个API密钥单独配置可用模型
- 未选择模型时默认启用所有模型

#### 模型配置界面
- 新增"模型配置"按钮，支持后续修改
- 直观的模型选择界面，显示模型名称和描述
- 实时显示已配置的可用模型列表

### 3. 增强的校对体验

#### 模型选择
- 主页现在显示具体的模型选项（如"DeepSeek - DeepSeek R1"）
- 支持从用户配置的所有模型中选择
- 显示当前可用模型总数

#### 改进的界面
- 新增字符计数和长度提醒功能
- 添加清空按钮，快速重置内容
- 增强的问题展示，支持问题分类和颜色标识
- 新增下载功能，保存校对结果为文本文件
- 改进的复制功能，带有视觉反馈

### 4. 数据库结构优化

#### 新增字段
- `api_key.enabled_models`: 存储启用的模型列表
- `proofreading_history.provider_used`: 记录使用的AI提供商
- `proofreading_history.model_used`: 记录使用的具体模型

#### 自动迁移
- 为现有数据自动推断并填充提供商信息
- 支持从旧版本无缝升级

### 5. 技术架构改进

#### AI服务架构
- 增强的基础服务类，支持动态模型参数
- 统一的HTTP服务基类，简化各服务实现
- 优化的服务工厂，支持模型参数传递

#### 配置管理
- 集中的模型配置管理
- 支持模型信息查询和验证
- 灵活的模型配置扩展机制

## 使用指南

### 1. 配置API密钥和模型

1. 访问"设置"页面
2. 选择AI服务提供商
3. 输入API密钥
4. 选择要启用的模型（可选，不选择则启用所有模型）
5. 保存配置

### 2. 管理现有模型配置

1. 在"已配置的API密钥"部分找到对应的服务商
2. 点击"模型配置"按钮
3. 在弹出的对话框中选择或取消选择模型
4. 保存配置

### 3. 使用模型进行校对

1. 在主页的"选择AI模型"下拉菜单中选择具体模型
2. 输入待校对的文本
3. 点击"开始校对"
4. 查看校对结果和问题分析

## 安全性和兼容性

- **向后兼容**: 现有的API密钥配置完全兼容，无需重新配置
- **数据安全**: 模型配置信息安全存储，不影响API密钥加密
- **错误处理**: 完善的错误处理机制，确保服务稳定性

## 开发者信息

本功能更新涉及以下核心组件：
- 配置管理 (`config.py`)
- 数据模型 (`models.py`)
- AI服务架构 (`ai_services/`)
- 前端界面 (`templates/`)
- API接口 (`app.py`)

所有修改遵循现有的代码规范和架构设计，确保系统的可维护性和扩展性。 